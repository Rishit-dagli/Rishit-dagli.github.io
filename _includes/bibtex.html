{% assign post_date = include.date | default: page.date %}
{% assign post_title = include.title | default: page.title %}
{% assign post_author = include.author | default: site.author | default: "Rishit Dagli" %}
{% assign post_url = include.url | default: page.url | prepend: site.url %}

{% assign year = post_date | date: "%Y" %}
{% assign month_name = post_date | date: "%B" %}
{% assign month_num = post_date | date: "%m" %}
{% assign day = post_date | date: "%d" %}
{% assign clean_title = post_title | remove: "**" | remove: "*" %}
{% assign author_last = post_author | split: " " | last %}
{% assign citation_key = author_last | downcase | append: year | append: clean_title | split: " " | first | downcase %}

<h2 id="citation">Citation</h2>

<p>Please cite this work as:</p>

<pre tabindex="0"><code>{{ post_author }}. "{{ clean_title }}". Rishit Dagli's Blog ({{ month_name }} {{ year }}). {{ post_url }}</code></pre>

<p>Or use the BibTex citation:</p>

<pre tabindex="0"><code id="citationCode">@article{ {{ citation_key }},
  title = { {{ clean_title }} },
  author = { {{ post_author }} },
  journal = {rishit-dagli.github.io},
  year = { {{ year }} },
  month = { {{ month_name }} },
  url = "{{ post_url }}"
}</code></pre>

<style>
pre {
  position: relative;
}

.copy-code {
  display: none;
  position: absolute;
  top: 4px;
  right: 4px;
  color: rgba(255,255,255,.8);
  background: rgba(78,78,78,.8);
  border-radius: 4px;
  padding: 2px 8px;
  font-size: 12px;
  user-select: none;
  cursor: pointer;
  border: none;
  font-family: inherit;
}

pre:hover .copy-code {
  display: block;
}

.copy-code:hover {
  background: rgba(78,78,78,1);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const codeBlocks = document.querySelectorAll('pre code');
  
  codeBlocks.forEach(function(codeBlock) {
    const pre = codeBlock.parentNode;
    
    // Create copy button
    const copyButton = document.createElement('button');
    copyButton.className = 'copy-code';
    copyButton.innerText = 'copy';
    
    // Copy functionality
    copyButton.addEventListener('click', function() {
      if (navigator.clipboard) {
        navigator.clipboard.writeText(codeBlock.textContent).then(function() {
          copyButton.innerText = 'copied!';
          setTimeout(() => {
            copyButton.innerText = 'copy';
          }, 2000);
        });
      } else {
        // Fallback for older browsers
        const range = document.createRange();
        range.selectNodeContents(codeBlock);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        try {
          document.execCommand('copy');
          copyButton.innerText = 'copied!';
          setTimeout(() => {
            copyButton.innerText = 'copy';
          }, 2000);
        } catch (err) {
          console.error('Copy failed:', err);
        }
        selection.removeAllRanges();
      }
    });
    
    pre.appendChild(copyButton);
  });
});
</script>